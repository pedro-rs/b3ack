from django.contrib.auth import authenticate, login, logout
from django.shortcuts import render
from django.http import HttpResponseRedirect, JsonResponse
from django.urls import reverse
from django.db import IntegrityError
from django.contrib.auth.decorators import login_required
from django.views.decorators.csrf import csrf_exempt
from django.contrib.auth.decorators import login_required

import json

from b3ack.utils.b3api import B3api
from b3ack.utils.bcolors import bcolors
from b3ack.utils.tracking import Tracking

# Models
from .models import InvestorUser, CompanyTracker

# Needed since using 
from django.contrib.auth import get_user_model
User = get_user_model()

def index_view(request):
    return render(request, "b3ack/index.html", {
        "message": "As senhas devem ser iguais."
    })


def login_view(request):
    if request.method == "POST":
        # Attempt to authenticate user
        username = request.POST["username"]
        password = request.POST["password"]

        redirect = request.session['redirect']
        redirect_code = request.session['redirect_code']

        user = authenticate(request, username=username, password=password)
        if user is not None:
            # Authentication successful
            login(request, user)
            if redirect is not None:
                return HttpResponseRedirect(reverse(redirect, args=(redirect_code,)))
            else:
                return HttpResponseRedirect(reverse("index"))

        else:
            # Authentication failed
            return render(request, "b3ack/login.html", {
                "message": "Credenciais incorretas!"
            })

    else:
        if not request.user.is_authenticated:
            redirect = request.GET.get('redirect')
            code = request.GET.get('code')

            request.session['redirect'] = redirect
            request.session['redirect_code'] = code

            return render(request, "b3ack/login.html")
        else:
            return HttpResponseRedirect(reverse("index"))

def logout_view(request):
    logout(request)
    return HttpResponseRedirect(reverse("index"))


def register_view(request):
    if request.method == "POST":
        username = request.POST["username"]
        email = request.POST["email"]

        # Ensure password matches confirmation
        password = request.POST["password"]
        confirmation = request.POST["confirmation"]
        if password != confirmation:
            return render(request, "b3ack/register.html", {
                "message": "As senhas devem ser iguais."
            })

        # Attempt to create new user
        try:
            user = User.objects.create_user(username, email, password)
            user.save()
        except IntegrityError as e:
            return render(request, "b3ack/register.html", {
                "message": "Email ou nome de usuário indisponível."
            })
        login(request, user)
        return HttpResponseRedirect(reverse("index"))

    else:
        if not request.user.is_authenticated:
            return render(request, "b3ack/register.html")
        else:
            return HttpResponseRedirect(reverse("index"))


def search_view(request):
    api = B3api()

    return render(request, "b3ack/search.html", {
        "data": api.data.values()
    })

def company_view(request, code):
    # api = B3api()
    # company = api.data[code]
    # quotes = api.get_quotes(code=code)

    if request.user.is_authenticated and len(request.user.watchlist.filter(code=code)) != 0:
        # User currently has this company os his watchlist
        # Therefore, display graph os tracked stock data
        data = dict()

        company_data = request.user.watchlist.filter(code=code)[0]
        data['labels'] = company_data.capture_dt
        data['values'] = company_data.abr

    else:
        data = None

    company = {'id': 1, 'cd_acao_rdz': 'CSAN', 'nm_empresa': 'COSAN', 'setor_economico': 'PETRÓLEO, GÁS E BIOCOMBUSTÍVEIS', 'subsetor': 'PETRÓLEO, GÁS E BIOCOMBUSTÍVEIS', 'segmento': 'EXPLORAÇÃO, REFINO E DISTRIBUIÇÃO', 'segmento_b3': 'NM', 'nm_segmento_b3': '', 'cd_acao': 'CSAN3', 'tx_cnpj': '50.746.577/0001-15', 'vl_cnpj': '50746577000115', 'created_at': '2021-10-22T01:00:01.000000Z', 'updated_at': '2021-10-22T01:00:01.000000Z'}
    quotes = {'CSANX148': {'id': 7146315, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX148', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.1, 'vl_maximo': 0.16, 'vl_minimo': 0.1, 'vl_medio': 0.15, 'vl_fechamento': 0.16, 'vl_mlh_oft_compra': 0.11, 'vl_mlh_oft_venda': 0.44, 'vl_ttl_neg': 2, 'qt_tit_neg': 1600, 'vl_volume': 250, 'vl_exec_opc': 14.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANX153': {'id': 7146314, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX153', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.24, 'vl_maximo': 0.24, 'vl_minimo': 0.24, 'vl_medio': 0.24, 'vl_fechamento': 0.24, 'vl_mlh_oft_compra': 0.08, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 600, 'vl_volume': 144, 'vl_exec_opc': 15.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANL190': {'id': 7154018, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL190', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.32, 'vl_maximo': 0.32, 'vl_minimo': 0.16, 'vl_medio': 0.24, 'vl_fechamento': 0.22, 'vl_mlh_oft_compra': 0.2, 'vl_mlh_oft_venda': 0.26, 'vl_ttl_neg': 25, 'qt_tit_neg': 95000, 'vl_volume': 22873, 'vl_exec_opc': 18.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA180': {'id': 7146303, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '78', 'cd_acao': 'CSANA180', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.21, 'vl_maximo': 1.21, 'vl_minimo': 0.93, 'vl_medio': 1.07, 'vl_fechamento': 0.93, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 9, 'qt_tit_neg': 12200, 'vl_volume': 13114, 'vl_exec_opc': 18, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:43.000000Z', 'updated_at': '2022-11-19T02:30:43.000000Z'}, 'CSANX159': {'id': 7154064, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX159', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.34, 'vl_maximo': 0.57, 'vl_minimo': 0.29, 'vl_medio': 0.45, 'vl_fechamento': 0.4, 'vl_mlh_oft_compra': 0.1, 'vl_mlh_oft_venda': 0.45, 'vl_ttl_neg': 16, 'qt_tit_neg': 15100, 'vl_volume': 6795, 'vl_exec_opc': 16.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX160': {'id': 7154022, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX160', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.27, 'vl_maximo': 0.37, 'vl_minimo': 0.25, 'vl_medio': 0.29, 'vl_fechamento': 0.28, 'vl_mlh_oft_compra': 0.13, 'vl_mlh_oft_venda': 0.31, 'vl_ttl_neg': 20, 'qt_tit_neg': 11500, 'vl_volume': 3441, 'vl_exec_opc': 15.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX173': {'id': 7146310, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX173', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.68, 'vl_maximo': 0.87, 'vl_minimo': 0.62, 'vl_medio': 0.72, 'vl_fechamento': 0.82, 'vl_mlh_oft_compra': 0.6, 'vl_mlh_oft_venda': 1.05, 'vl_ttl_neg': 32, 'qt_tit_neg': 35300, 'vl_volume': 25484, 'vl_exec_opc': 17.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANL173': {'id': 7154032, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL173', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.88, 'vl_maximo': 0.88, 'vl_minimo': 0.56, 'vl_medio': 0.58, 'vl_fechamento': 0.59, 'vl_mlh_oft_compra': 0.47, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 10, 'qt_tit_neg': 7200, 'vl_volume': 4215, 'vl_exec_opc': 17.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM180': {'id': 7154077, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM180', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.28, 'vl_maximo': 1.58, 'vl_minimo': 1.27, 'vl_medio': 1.27, 'vl_fechamento': 1.58, 'vl_mlh_oft_compra': 0.1, 'vl_mlh_oft_venda': 1.65, 'vl_ttl_neg': 4, 'qt_tit_neg': 40300, 'vl_volume': 51374, 'vl_exec_opc': 18, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA200': {'id': 7154048, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANA200', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.24, 'vl_maximo': 0.24, 'vl_minimo': 0.24, 'vl_medio': 0.24, 'vl_fechamento': 0.24, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.37, 'vl_ttl_neg': 1, 'qt_tit_neg': 200, 'vl_volume': 48, 'vl_exec_opc': 20, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL170': {'id': 7154015, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL170', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.3, 'vl_maximo': 1.3, 'vl_minimo': 0.77, 'vl_medio': 0.97, 'vl_fechamento': 0.96, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 2.45, 'vl_ttl_neg': 62, 'qt_tit_neg': 85400, 'vl_volume': 82857, 'vl_exec_opc': 16.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX170': {'id': 7154019, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX170', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.4, 'vl_maximo': 0.77, 'vl_minimo': 0.4, 'vl_medio': 0.67, 'vl_fechamento': 0.64, 'vl_mlh_oft_compra': 0.53, 'vl_mlh_oft_venda': 1.5, 'vl_ttl_neg': 16, 'qt_tit_neg': 8500, 'vl_volume': 5739, 'vl_exec_opc': 16.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX210': {'id': 7173045, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '82', 'cd_acao': 'CSANX210', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 3.8, 'vl_maximo': 3.8, 'vl_minimo': 3.8, 'vl_medio': 3.8, 'vl_fechamento': 3.8, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 3800, 'vl_exec_opc': 21.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANL210': {'id': 7154024, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL210', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.06, 'vl_maximo': 0.06, 'vl_minimo': 0.06, 'vl_medio': 0.06, 'vl_fechamento': 0.06, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0.45, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 6, 'vl_exec_opc': 21.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA195': {'id': 7146306, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '78', 'cd_acao': 'CSANA195', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.45, 'vl_maximo': 0.46, 'vl_minimo': 0.45, 'vl_medio': 0.45, 'vl_fechamento': 0.46, 'vl_mlh_oft_compra': 0.35, 'vl_mlh_oft_venda': 0.97, 'vl_ttl_neg': 3, 'qt_tit_neg': 2700, 'vl_volume': 1216, 'vl_exec_opc': 19.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANA160': {'id': 7172990, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '78', 'cd_acao': 'CSANA160', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.8, 'vl_maximo': 1.9, 'vl_minimo': 1.8, 'vl_medio': 1.83, 'vl_fechamento': 1.9, 'vl_mlh_oft_compra': 0.1, 'vl_mlh_oft_venda': 2.91, 'vl_ttl_neg': 69, 'qt_tit_neg': 401100, 'vl_volume': 735876, 'vl_exec_opc': 16, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSAN3': {'id': 7151654, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '02', 'cd_acao': 'CSAN3', 'tp_merc': 10, 'nm_empresa_rdz': 'COSAN', 'especi': 'ON NM', 'prazot': '', 'moeda_ref': 'R$', 'vl_abertura': 16.95, 'vl_maximo': 17.39, 'vl_minimo': 16.34, 'vl_medio': 16.76, 'vl_fechamento': 16.77, 'vl_mlh_oft_compra': 16.76, 'vl_mlh_oft_venda': 16.77, 'vl_ttl_neg': 24606, 'qt_tit_neg': 9535900, 'vl_volume': 159908748, 'vl_exec_opc': 0, 'in_opc': '0', 'dt_vnct_opc': 99991231, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:39.000000Z', 'updated_at': '2022-11-22T00:45:39.000000Z'}, 'CSANL188': {'id': 7154029, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL188', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.23, 'vl_maximo': 0.28, 'vl_minimo': 0.15, 'vl_medio': 0.23, 'vl_fechamento': 0.17, 'vl_mlh_oft_compra': 0.15, 'vl_mlh_oft_venda': 0.3, 'vl_ttl_neg': 35, 'qt_tit_neg': 172500, 'vl_volume': 40531, 'vl_exec_opc': 18.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL179': {'id': 7154035, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL179', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.5, 'vl_maximo': 0.5, 'vl_minimo': 0.23, 'vl_medio': 0.33, 'vl_fechamento': 0.31, 'vl_mlh_oft_compra': 0.34, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 63, 'qt_tit_neg': 313300, 'vl_volume': 103842, 'vl_exec_opc': 18.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA165': {'id': 7160623, 'tp_reg': 1, 'dt_pregao': 20221122, 'cd_bdi': '78', 'cd_acao': 'CSANA165', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.49, 'vl_maximo': 1.52, 'vl_minimo': 1.35, 'vl_medio': 1.41, 'vl_fechamento': 1.35, 'vl_mlh_oft_compra': 0.75, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 15, 'qt_tit_neg': 22200, 'vl_volume': 31453, 'vl_exec_opc': 16.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-23T00:45:40.000000Z', 'updated_at': '2022-11-23T00:45:40.000000Z'}, 'CSANL205': {'id': 7154039, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL205', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.06, 'vl_maximo': 0.06, 'vl_minimo': 0.06, 'vl_medio': 0.06, 'vl_fechamento': 0.06, 'vl_mlh_oft_compra': 0.05, 'vl_mlh_oft_venda': 0.06, 'vl_ttl_neg': 2, 'qt_tit_neg': 700, 'vl_volume': 42, 'vl_exec_opc': 20.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANB187': {'id': 7154051, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANB187', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.82, 'vl_maximo': 0.82, 'vl_minimo': 0.77, 'vl_medio': 0.8, 'vl_fechamento': 0.79, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 8, 'qt_tit_neg': 900, 'vl_volume': 726, 'vl_exec_opc': 18.75, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL195': {'id': 7154037, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL195', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.08, 'vl_maximo': 0.1, 'vl_minimo': 0.08, 'vl_medio': 0.08, 'vl_fechamento': 0.1, 'vl_mlh_oft_compra': 0.08, 'vl_mlh_oft_venda': 0.12, 'vl_ttl_neg': 4, 'qt_tit_neg': 11200, 'vl_volume': 952, 'vl_exec_opc': 19.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL180': {'id': 7154017, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL180', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.61, 'vl_maximo': 0.65, 'vl_minimo': 0.38, 'vl_medio': 0.47, 'vl_fechamento': 0.5, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.73, 'vl_ttl_neg': 24, 'qt_tit_neg': 26500, 'vl_volume': 12709, 'vl_exec_opc': 17.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL189': {'id': 7154036, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL189', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.17, 'vl_maximo': 0.18, 'vl_minimo': 0.13, 'vl_medio': 0.15, 'vl_fechamento': 0.18, 'vl_mlh_oft_compra': 0.13, 'vl_mlh_oft_venda': 0.2, 'vl_ttl_neg': 5, 'qt_tit_neg': 1100, 'vl_volume': 169, 'vl_exec_opc': 19.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL168': {'id': 7154033, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL168', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.65, 'vl_maximo': 0.66, 'vl_minimo': 0.65, 'vl_medio': 0.65, 'vl_fechamento': 0.65, 'vl_mlh_oft_compra': 0.65, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 4, 'qt_tit_neg': 4200, 'vl_volume': 2746, 'vl_exec_opc': 16.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL178': {'id': 7154031, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL178', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.62, 'vl_maximo': 0.62, 'vl_minimo': 0.37, 'vl_medio': 0.48, 'vl_fechamento': 0.42, 'vl_mlh_oft_compra': 0.37, 'vl_mlh_oft_venda': 0.53, 'vl_ttl_neg': 16, 'qt_tit_neg': 15100, 'vl_volume': 7395, 'vl_exec_opc': 17.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM155': {'id': 7154074, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM155', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.5, 'vl_maximo': 0.6, 'vl_minimo': 0.5, 'vl_medio': 0.55, 'vl_fechamento': 0.53, 'vl_mlh_oft_compra': 0.15, 'vl_mlh_oft_venda': 0.52, 'vl_ttl_neg': 14, 'qt_tit_neg': 3000, 'vl_volume': 1670, 'vl_exec_opc': 15.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX150': {'id': 7154063, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX150', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.16, 'vl_maximo': 0.27, 'vl_minimo': 0.16, 'vl_medio': 0.24, 'vl_fechamento': 0.16, 'vl_mlh_oft_compra': 0.07, 'vl_mlh_oft_venda': 0.23, 'vl_ttl_neg': 23, 'qt_tit_neg': 24300, 'vl_volume': 6024, 'vl_exec_opc': 15.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA170': {'id': 7154044, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANA170', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.6, 'vl_maximo': 1.6, 'vl_minimo': 1.23, 'vl_medio': 1.3900000000000001, 'vl_fechamento': 1.3, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 3, 'vl_ttl_neg': 42, 'qt_tit_neg': 232900, 'vl_volume': 324457, 'vl_exec_opc': 17, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL183': {'id': 7154030, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL183', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.41, 'vl_maximo': 0.41, 'vl_minimo': 0.18, 'vl_medio': 0.3, 'vl_fechamento': 0.26, 'vl_mlh_oft_compra': 0.26, 'vl_mlh_oft_venda': 0.39, 'vl_ttl_neg': 21, 'qt_tit_neg': 27600, 'vl_volume': 8320, 'vl_exec_opc': 18.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANB180': {'id': 7173000, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '78', 'cd_acao': 'CSANB180', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.1, 'vl_maximo': 1.1, 'vl_minimo': 1.1, 'vl_medio': 1.1, 'vl_fechamento': 1.1, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 2, 'qt_tit_neg': 200, 'vl_volume': 220, 'vl_exec_opc': 18, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANX175': {'id': 7154020, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX175', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.67, 'vl_maximo': 1.04, 'vl_minimo': 0.67, 'vl_medio': 0.84, 'vl_fechamento': 0.81, 'vl_mlh_oft_compra': 0.69, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 9, 'qt_tit_neg': 5900, 'vl_volume': 4960, 'vl_exec_opc': 17.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL159': {'id': 7160615, 'tp_reg': 1, 'dt_pregao': 20221122, 'cd_bdi': '78', 'cd_acao': 'CSANL159', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.22, 'vl_maximo': 1.27, 'vl_minimo': 0.7, 'vl_medio': 0.82, 'vl_fechamento': 0.7, 'vl_mlh_oft_compra': 0.7, 'vl_mlh_oft_venda': 1.65, 'vl_ttl_neg': 4, 'qt_tit_neg': 1300, 'vl_volume': 1071, 'vl_exec_opc': 16.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-23T00:45:40.000000Z', 'updated_at': '2022-11-23T00:45:40.000000Z'}, 'CSANX168': {'id': 7146311, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX168', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.61, 'vl_maximo': 0.66, 'vl_minimo': 0.46, 'vl_medio': 0.62, 'vl_fechamento': 0.6, 'vl_mlh_oft_compra': 0.29, 'vl_mlh_oft_venda': 0.84, 'vl_ttl_neg': 6, 'qt_tit_neg': 2400, 'vl_volume': 1491, 'vl_exec_opc': 16.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANB202': {'id': 7146300, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '78', 'cd_acao': 'CSANB202', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.7, 'vl_maximo': 0.7, 'vl_minimo': 0.7, 'vl_medio': 0.7, 'vl_fechamento': 0.7, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 1, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 700, 'vl_exec_opc': 20.25, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:43.000000Z', 'updated_at': '2022-11-19T02:30:43.000000Z'}, 'CSANM190': {'id': 7166889, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANM190', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2.35, 'vl_maximo': 2.35, 'vl_minimo': 2.35, 'vl_medio': 2.35, 'vl_fechamento': 2.35, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 5000, 'vl_volume': 11750, 'vl_exec_opc': 19, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANM145': {'id': 7154072, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM145', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.3, 'vl_maximo': 0.33, 'vl_minimo': 0.2, 'vl_medio': 0.28, 'vl_fechamento': 0.25, 'vl_mlh_oft_compra': 0.11, 'vl_mlh_oft_venda': 0.29, 'vl_ttl_neg': 18, 'qt_tit_neg': 4300, 'vl_volume': 1236, 'vl_exec_opc': 14.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA185': {'id': 7146304, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '78', 'cd_acao': 'CSANA185', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.98, 'vl_maximo': 1, 'vl_minimo': 0.8, 'vl_medio': 0.88, 'vl_fechamento': 0.8, 'vl_mlh_oft_compra': 0.08, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 7, 'qt_tit_neg': 9100, 'vl_volume': 8036, 'vl_exec_opc': 18.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:43.000000Z', 'updated_at': '2022-11-19T02:30:43.000000Z'}, 'CSANB185': {'id': 7173001, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '78', 'cd_acao': 'CSANB185', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.9, 'vl_maximo': 0.9, 'vl_minimo': 0.9, 'vl_medio': 0.9, 'vl_fechamento': 0.9, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 90, 'vl_exec_opc': 18.5, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANC300': {'id': 7173004, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '78', 'cd_acao': 'CSANC300', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.05, 'vl_maximo': 0.05, 'vl_minimo': 0.05, 'vl_medio': 0.05, 'vl_fechamento': 0.05, 'vl_mlh_oft_compra': 0.05, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 5000, 'vl_volume': 250, 'vl_exec_opc': 30, 'in_opc': '0', 'dt_vnct_opc': 20230317, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANL175': {'id': 7154016, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL175', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.97, 'vl_maximo': 0.98, 'vl_minimo': 0.62, 'vl_medio': 0.75, 'vl_fechamento': 0.72, 'vl_mlh_oft_compra': 0.56, 'vl_mlh_oft_venda': 1.8, 'vl_ttl_neg': 26, 'qt_tit_neg': 44900, 'vl_volume': 33745, 'vl_exec_opc': 17.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL223': {'id': 7173022, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '78', 'cd_acao': 'CSANL223', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.02, 'vl_maximo': 0.02, 'vl_minimo': 0.02, 'vl_medio': 0.02, 'vl_fechamento': 0.02, 'vl_mlh_oft_compra': 0.02, 'vl_mlh_oft_venda': 0.05, 'vl_ttl_neg': 1, 'qt_tit_neg': 1400, 'vl_volume': 28, 'vl_exec_opc': 22.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANA210': {'id': 7154050, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANA210', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.18, 'vl_maximo': 0.18, 'vl_minimo': 0.18, 'vl_medio': 0.18, 'vl_fechamento': 0.18, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 1200, 'vl_volume': 216, 'vl_exec_opc': 21, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX143': {'id': 7154060, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX143', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.11, 'vl_maximo': 0.11, 'vl_minimo': 0.1, 'vl_medio': 0.1, 'vl_fechamento': 0.1, 'vl_mlh_oft_compra': 0.05, 'vl_mlh_oft_venda': 0.14, 'vl_ttl_neg': 5, 'qt_tit_neg': 3200, 'vl_volume': 322, 'vl_exec_opc': 14.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA175': {'id': 7154043, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANA175', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.21, 'vl_maximo': 1.21, 'vl_minimo': 0.88, 'vl_medio': 1.15, 'vl_fechamento': 1, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 6, 'qt_tit_neg': 8100, 'vl_volume': 9316, 'vl_exec_opc': 17.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX178': {'id': 7146309, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX178', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.97, 'vl_maximo': 1.21, 'vl_minimo': 0.86, 'vl_medio': 0.97, 'vl_fechamento': 1.15, 'vl_mlh_oft_compra': 0.33, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 50, 'qt_tit_neg': 76500, 'vl_volume': 74864, 'vl_exec_opc': 17.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANL200': {'id': 7154038, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL200', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.07, 'vl_maximo': 0.09, 'vl_minimo': 0.05, 'vl_medio': 0.07, 'vl_fechamento': 0.09, 'vl_mlh_oft_compra': 0.06, 'vl_mlh_oft_venda': 0.1, 'vl_ttl_neg': 4, 'qt_tit_neg': 1200, 'vl_volume': 86, 'vl_exec_opc': 20.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX158': {'id': 7146313, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX158', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.19, 'vl_maximo': 0.3, 'vl_minimo': 0.19, 'vl_medio': 0.25, 'vl_fechamento': 0.29, 'vl_mlh_oft_compra': 0.25, 'vl_mlh_oft_venda': 0.43, 'vl_ttl_neg': 9, 'qt_tit_neg': 5100, 'vl_volume': 1297, 'vl_exec_opc': 15.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANM170': {'id': 7154076, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM170', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1, 'vl_maximo': 1.07, 'vl_minimo': 1, 'vl_medio': 1.03, 'vl_fechamento': 1.06, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 4, 'qt_tit_neg': 900, 'vl_volume': 931, 'vl_exec_opc': 17, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM150': {'id': 7154073, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM150', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.28, 'vl_maximo': 0.46, 'vl_minimo': 0.28, 'vl_medio': 0.42, 'vl_fechamento': 0.39, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.4, 'vl_ttl_neg': 12, 'qt_tit_neg': 17800, 'vl_volume': 7653, 'vl_exec_opc': 15, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX140': {'id': 7173032, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '82', 'cd_acao': 'CSANX140', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.03, 'vl_maximo': 0.03, 'vl_minimo': 0.03, 'vl_medio': 0.03, 'vl_fechamento': 0.03, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.7, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 30, 'vl_exec_opc': 14.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANA190': {'id': 7146305, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '78', 'cd_acao': 'CSANA190', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.67, 'vl_maximo': 0.73, 'vl_minimo': 0.62, 'vl_medio': 0.69, 'vl_fechamento': 0.62, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.66, 'vl_ttl_neg': 8, 'qt_tit_neg': 39500, 'vl_volume': 27510, 'vl_exec_opc': 19, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANN200': {'id': 7173031, 'tp_reg': 1, 'dt_pregao': 20221124, 'cd_bdi': '82', 'cd_acao': 'CSANN200', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2.66, 'vl_maximo': 2.67, 'vl_minimo': 2.56, 'vl_medio': 2.63, 'vl_fechamento': 2.59, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 8, 'qt_tit_neg': 105100, 'vl_volume': 276646, 'vl_exec_opc': 20, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-25T00:45:39.000000Z', 'updated_at': '2022-11-25T00:45:39.000000Z'}, 'CSANL198': {'id': 7154027, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL198', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.08, 'vl_maximo': 0.09, 'vl_minimo': 0.05, 'vl_medio': 0.08, 'vl_fechamento': 0.05, 'vl_mlh_oft_compra': 0.06, 'vl_mlh_oft_venda': 0.1, 'vl_ttl_neg': 6, 'qt_tit_neg': 9300, 'vl_volume': 773, 'vl_exec_opc': 19.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM165': {'id': 7154075, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM165', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.67, 'vl_maximo': 1, 'vl_minimo': 0.67, 'vl_medio': 0.87, 'vl_fechamento': 0.86, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.82, 'vl_ttl_neg': 17, 'qt_tit_neg': 9000, 'vl_volume': 7843, 'vl_exec_opc': 16.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM175': {'id': 7154069, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM175', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.02, 'vl_maximo': 1.5, 'vl_minimo': 1.02, 'vl_medio': 1.31, 'vl_fechamento': 1.27, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 11, 'qt_tit_neg': 10300, 'vl_volume': 13566, 'vl_exec_opc': 17.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANN172': {'id': 7166893, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANN172', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1, 'vl_maximo': 1, 'vl_minimo': 1, 'vl_medio': 1, 'vl_fechamento': 1, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 2000, 'vl_volume': 2000, 'vl_exec_opc': 17.25, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANX189': {'id': 7166877, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANX189', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2.45, 'vl_maximo': 2.45, 'vl_minimo': 2.43, 'vl_medio': 2.43, 'vl_fechamento': 2.43, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 3, 'qt_tit_neg': 4000, 'vl_volume': 9722, 'vl_exec_opc': 19.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANL230': {'id': 7154041, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL230', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.16, 'vl_maximo': 0.16, 'vl_minimo': 0.16, 'vl_medio': 0.16, 'vl_fechamento': 0.16, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.2, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 16, 'vl_exec_opc': 23.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM185': {'id': 7154078, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM185', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.85, 'vl_maximo': 1.85, 'vl_minimo': 1.85, 'vl_medio': 1.85, 'vl_fechamento': 1.85, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 200, 'vl_volume': 370, 'vl_exec_opc': 18.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANN155': {'id': 7154070, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANN155', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.6, 'vl_maximo': 0.6, 'vl_minimo': 0.5, 'vl_medio': 0.5, 'vl_fechamento': 0.55, 'vl_mlh_oft_compra': 0.45, 'vl_mlh_oft_venda': 0.56, 'vl_ttl_neg': 18, 'qt_tit_neg': 17700, 'vl_volume': 9007, 'vl_exec_opc': 15.5, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX179': {'id': 7154065, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX179', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.19, 'vl_maximo': 1.4, 'vl_minimo': 1.19, 'vl_medio': 1.29, 'vl_fechamento': 1.4, 'vl_mlh_oft_compra': 1, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 2, 'qt_tit_neg': 200, 'vl_volume': 259, 'vl_exec_opc': 18.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM160': {'id': 7154068, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM160', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.75, 'vl_maximo': 0.8, 'vl_minimo': 0.65, 'vl_medio': 0.73, 'vl_fechamento': 0.65, 'vl_mlh_oft_compra': 0.35, 'vl_mlh_oft_venda': 0.65, 'vl_ttl_neg': 4, 'qt_tit_neg': 7100, 'vl_volume': 5210, 'vl_exec_opc': 16, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX200': {'id': 7166878, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANX200', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 3.5, 'vl_maximo': 3.5, 'vl_minimo': 3.5, 'vl_medio': 3.5, 'vl_fechamento': 3.5, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 5000, 'vl_volume': 17500, 'vl_exec_opc': 20.07, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANL153': {'id': 7166849, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '78', 'cd_acao': 'CSANL153', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.65, 'vl_maximo': 1.65, 'vl_minimo': 1.65, 'vl_medio': 1.65, 'vl_fechamento': 1.65, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 1500, 'vl_volume': 2475, 'vl_exec_opc': 15.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANX180': {'id': 7154021, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX180', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.87, 'vl_maximo': 1.24, 'vl_minimo': 0.87, 'vl_medio': 0.93, 'vl_fechamento': 1.19, 'vl_mlh_oft_compra': 0.18, 'vl_mlh_oft_venda': 1.28, 'vl_ttl_neg': 14, 'qt_tit_neg': 49400, 'vl_volume': 46031, 'vl_exec_opc': 17.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX198': {'id': 7166865, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANX198', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 3.2, 'vl_maximo': 3.2, 'vl_minimo': 3.2, 'vl_medio': 3.2, 'vl_fechamento': 3.2, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 2000, 'vl_volume': 6400, 'vl_exec_opc': 19.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANX163': {'id': 7146312, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX163', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE FM', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.34, 'vl_maximo': 0.49, 'vl_minimo': 0.32, 'vl_medio': 0.44, 'vl_fechamento': 0.49, 'vl_mlh_oft_compra': 0.15, 'vl_mlh_oft_venda': 0.55, 'vl_ttl_neg': 7, 'qt_tit_neg': 5300, 'vl_volume': 2348, 'vl_exec_opc': 16.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANL163': {'id': 7166848, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '78', 'cd_acao': 'CSANL163', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.83, 'vl_maximo': 0.83, 'vl_minimo': 0.8, 'vl_medio': 0.8, 'vl_fechamento': 0.8, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 3, 'qt_tit_neg': 3500, 'vl_volume': 2824, 'vl_exec_opc': 16.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANL193': {'id': 7154028, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL193', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.29, 'vl_maximo': 0.29, 'vl_minimo': 0.13, 'vl_medio': 0.14, 'vl_fechamento': 0.15, 'vl_mlh_oft_compra': 0.09, 'vl_mlh_oft_venda': 0.25, 'vl_ttl_neg': 7, 'qt_tit_neg': 16700, 'vl_volume': 2372, 'vl_exec_opc': 19.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM157': {'id': 7154080, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM157', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.56, 'vl_maximo': 0.7, 'vl_minimo': 0.56, 'vl_medio': 0.57, 'vl_fechamento': 0.57, 'vl_mlh_oft_compra': 0.17, 'vl_mlh_oft_venda': 0.6, 'vl_ttl_neg': 4, 'qt_tit_neg': 1300, 'vl_volume': 752, 'vl_exec_opc': 15.75, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANN190': {'id': 7166892, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANN190', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2.4, 'vl_maximo': 2.4, 'vl_minimo': 2.4, 'vl_medio': 2.4, 'vl_fechamento': 2.4, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 2400, 'vl_exec_opc': 19, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANN147': {'id': 7154067, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANN147', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.4, 'vl_maximo': 0.4, 'vl_minimo': 0.4, 'vl_medio': 0.4, 'vl_fechamento': 0.4, 'vl_mlh_oft_compra': 0.3, 'vl_mlh_oft_venda': 0.5, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 400, 'vl_exec_opc': 14.75, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANN160': {'id': 7166891, 'tp_reg': 1, 'dt_pregao': 20221123, 'cd_bdi': '82', 'cd_acao': 'CSANN160', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.75, 'vl_maximo': 0.75, 'vl_minimo': 0.75, 'vl_medio': 0.75, 'vl_fechamento': 0.75, 'vl_mlh_oft_compra': 0.65, 'vl_mlh_oft_venda': 1.09, 'vl_ttl_neg': 1, 'qt_tit_neg': 1000, 'vl_volume': 750, 'vl_exec_opc': 16, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-24T00:45:42.000000Z', 'updated_at': '2022-11-24T00:45:42.000000Z'}, 'CSANB155': {'id': 7160622, 'tp_reg': 1, 'dt_pregao': 20221122, 'cd_bdi': '78', 'cd_acao': 'CSANB155', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2, 'vl_maximo': 2, 'vl_minimo': 2, 'vl_medio': 2, 'vl_fechamento': 2, 'vl_mlh_oft_compra': 2, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 500, 'vl_volume': 1000, 'vl_exec_opc': 15.5, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-23T00:45:40.000000Z', 'updated_at': '2022-11-23T00:45:40.000000Z'}, 'CSANL203': {'id': 7154026, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL203', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.05, 'vl_maximo': 0.05, 'vl_minimo': 0.05, 'vl_medio': 0.05, 'vl_fechamento': 0.05, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0.1, 'vl_ttl_neg': 9, 'qt_tit_neg': 8700, 'vl_volume': 435, 'vl_exec_opc': 20.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANA205': {'id': 7154049, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANA205', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.26, 'vl_maximo': 0.26, 'vl_minimo': 0.26, 'vl_medio': 0.26, 'vl_fechamento': 0.26, 'vl_mlh_oft_compra': 0.03, 'vl_mlh_oft_venda': 0.45, 'vl_ttl_neg': 1, 'qt_tit_neg': 2500, 'vl_volume': 650, 'vl_exec_opc': 20.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX183': {'id': 7146308, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX183', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.65, 'vl_maximo': 1.7, 'vl_minimo': 1.53, 'vl_medio': 1.6, 'vl_fechamento': 1.53, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 1.8, 'vl_ttl_neg': 3, 'qt_tit_neg': 20000, 'vl_volume': 32050, 'vl_exec_opc': 18.32, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANB160': {'id': 7160630, 'tp_reg': 1, 'dt_pregao': 20221122, 'cd_bdi': '78', 'cd_acao': 'CSANB160', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.8, 'vl_maximo': 1.8, 'vl_minimo': 1.8, 'vl_medio': 1.8, 'vl_fechamento': 1.8, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 180, 'vl_exec_opc': 16, 'in_opc': '0', 'dt_vnct_opc': 20230217, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-23T00:45:40.000000Z', 'updated_at': '2022-11-23T00:45:40.000000Z'}, 'CSANU150': {'id': 7154066, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANU150', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1, 'vl_maximo': 1, 'vl_minimo': 1, 'vl_medio': 1, 'vl_fechamento': 1, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 5000, 'vl_volume': 5000, 'vl_exec_opc': 15, 'in_opc': '0', 'dt_vnct_opc': 20240920, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX190': {'id': 7154023, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX190', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2, 'vl_maximo': 2, 'vl_minimo': 1.9, 'vl_medio': 1.99, 'vl_fechamento': 1.9, 'vl_mlh_oft_compra': 0.1, 'vl_mlh_oft_venda': 2.2, 'vl_ttl_neg': 2, 'qt_tit_neg': 1100, 'vl_volume': 2190, 'vl_exec_opc': 18.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANI150': {'id': 7154042, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANI150', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 5.48, 'vl_maximo': 5.48, 'vl_minimo': 5.48, 'vl_medio': 5.48, 'vl_fechamento': 5.48, 'vl_mlh_oft_compra': 5.48, 'vl_mlh_oft_venda': 6.37, 'vl_ttl_neg': 2, 'qt_tit_neg': 1300, 'vl_volume': 7124, 'vl_exec_opc': 15, 'in_opc': '0', 'dt_vnct_opc': 20240920, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL240': {'id': 7160601, 'tp_reg': 1, 'dt_pregao': 20221122, 'cd_bdi': '78', 'cd_acao': 'CSANL240', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.09, 'vl_maximo': 0.09, 'vl_minimo': 0.03, 'vl_medio': 0.04, 'vl_fechamento': 0.03, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.09, 'vl_ttl_neg': 8, 'qt_tit_neg': 1500, 'vl_volume': 61, 'vl_exec_opc': 23.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-23T00:45:40.000000Z', 'updated_at': '2022-11-23T00:45:40.000000Z'}, 'CSANL215': {'id': 7154040, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL215', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.04, 'vl_maximo': 0.04, 'vl_minimo': 0.04, 'vl_medio': 0.04, 'vl_fechamento': 0.04, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0.04, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 4, 'vl_exec_opc': 21.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANL208': {'id': 7154025, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANL208', 'tp_merc': 70, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.04, 'vl_maximo': 0.05, 'vl_minimo': 0.04, 'vl_medio': 0.04, 'vl_fechamento': 0.05, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0.05, 'vl_ttl_neg': 2, 'qt_tit_neg': 400, 'vl_volume': 18, 'vl_exec_opc': 20.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM210': {'id': 7154079, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM210', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 3.85, 'vl_maximo': 3.85, 'vl_minimo': 3.85, 'vl_medio': 3.85, 'vl_fechamento': 3.85, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 385, 'vl_exec_opc': 21, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANR300': {'id': 7154061, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANR300', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 11.3, 'vl_maximo': 11.3, 'vl_minimo': 11.3, 'vl_medio': 11.3, 'vl_fechamento': 11.3, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 1130, 'vl_exec_opc': 30, 'in_opc': '0', 'dt_vnct_opc': 20230616, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANX145': {'id': 7154062, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANX145', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.1, 'vl_maximo': 0.15, 'vl_minimo': 0.1, 'vl_medio': 0.14, 'vl_fechamento': 0.11, 'vl_mlh_oft_compra': 0.02, 'vl_mlh_oft_venda': 0.14, 'vl_ttl_neg': 6, 'qt_tit_neg': 2900, 'vl_volume': 407, 'vl_exec_opc': 14.57, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANM135': {'id': 7154071, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '82', 'cd_acao': 'CSANM135', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.15, 'vl_maximo': 0.16, 'vl_minimo': 0.15, 'vl_medio': 0.15, 'vl_fechamento': 0.16, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 6, 'qt_tit_neg': 6700, 'vl_volume': 1012, 'vl_exec_opc': 13.5, 'in_opc': '0', 'dt_vnct_opc': 20230120, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANF300': {'id': 7154034, 'tp_reg': 1, 'dt_pregao': 20221121, 'cd_bdi': '78', 'cd_acao': 'CSANF300', 'tp_merc': 70, 'nm_empresa_rdz': 'CSAN', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.02, 'vl_maximo': 0.02, 'vl_minimo': 0.02, 'vl_medio': 0.02, 'vl_fechamento': 0.02, 'vl_mlh_oft_compra': 0.02, 'vl_mlh_oft_venda': 0.9, 'vl_ttl_neg': 1, 'qt_tit_neg': 10000, 'vl_volume': 200, 'vl_exec_opc': 30, 'in_opc': '0', 'dt_vnct_opc': 20230616, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-22T00:45:49.000000Z', 'updated_at': '2022-11-22T00:45:49.000000Z'}, 'CSANW145': {'id': 7146318, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW145', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.01, 'vl_maximo': 0.01, 'vl_minimo': 0.01, 'vl_medio': 0.01, 'vl_fechamento': 0.01, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 3, 'qt_tit_neg': 300, 'vl_volume': 3, 'vl_exec_opc': 14.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW177': {'id': 7146329, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW177', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.4, 'vl_maximo': 0.53, 'vl_minimo': 0.4, 'vl_medio': 0.48, 'vl_fechamento': 0.53, 'vl_mlh_oft_compra': 0.04, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 4, 'qt_tit_neg': 700, 'vl_volume': 338, 'vl_exec_opc': 17.75, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW185': {'id': 7146325, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW185', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.07, 'vl_maximo': 1.07, 'vl_minimo': 1, 'vl_medio': 1.03, 'vl_fechamento': 1, 'vl_mlh_oft_compra': 0.8, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 5, 'qt_tit_neg': 4300, 'vl_volume': 4443, 'vl_exec_opc': 18.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANX188': {'id': 7146307, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANX188', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.53, 'vl_maximo': 1.53, 'vl_minimo': 1.53, 'vl_medio': 1.53, 'vl_fechamento': 1.53, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 2, 'qt_tit_neg': 1200, 'vl_volume': 1836, 'vl_exec_opc': 18.82, 'in_opc': '0', 'dt_vnct_opc': 20221216, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW165': {'id': 7146321, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW165', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.04, 'vl_maximo': 0.04, 'vl_minimo': 0.01, 'vl_medio': 0.03, 'vl_fechamento': 0.01, 'vl_mlh_oft_compra': 0.01, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 3, 'qt_tit_neg': 3300, 'vl_volume': 103, 'vl_exec_opc': 16.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW140': {'id': 7146317, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW140', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.01, 'vl_maximo': 0.01, 'vl_minimo': 0.01, 'vl_medio': 0.01, 'vl_fechamento': 0.01, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0.01, 'vl_ttl_neg': 1, 'qt_tit_neg': 200, 'vl_volume': 2, 'vl_exec_opc': 14, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW180': {'id': 7146324, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW180', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.62, 'vl_maximo': 0.7, 'vl_minimo': 0.6, 'vl_medio': 0.64, 'vl_fechamento': 0.7, 'vl_mlh_oft_compra': 0.4, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 3, 'qt_tit_neg': 1600, 'vl_volume': 1030, 'vl_exec_opc': 18, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW195': {'id': 7146327, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW195', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 2.2, 'vl_maximo': 2.2, 'vl_minimo': 2.2, 'vl_medio': 2.2, 'vl_fechamento': 2.2, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 1100, 'vl_volume': 2420, 'vl_exec_opc': 19.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW155': {'id': 7146320, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW155', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.01, 'vl_maximo': 0.01, 'vl_minimo': 0.01, 'vl_medio': 0.01, 'vl_fechamento': 0.01, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 400, 'vl_volume': 4, 'vl_exec_opc': 15.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW215': {'id': 7146328, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW215', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 4.25, 'vl_maximo': 4.25, 'vl_minimo': 4.25, 'vl_medio': 4.25, 'vl_fechamento': 4.25, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 2, 'qt_tit_neg': 2000, 'vl_volume': 8500, 'vl_exec_opc': 21.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW170': {'id': 7146322, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW170', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.05, 'vl_maximo': 0.08, 'vl_minimo': 0.03, 'vl_medio': 0.03, 'vl_fechamento': 0.03, 'vl_mlh_oft_compra': 0.02, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 30, 'qt_tit_neg': 257100, 'vl_volume': 8845, 'vl_exec_opc': 17, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW175': {'id': 7146323, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW175', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.25, 'vl_maximo': 0.29, 'vl_minimo': 0.19, 'vl_medio': 0.21, 'vl_fechamento': 0.19, 'vl_mlh_oft_compra': 0.15, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 11, 'qt_tit_neg': 2500, 'vl_volume': 542, 'vl_exec_opc': 17.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW190': {'id': 7146326, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW190', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 1.7, 'vl_maximo': 1.7, 'vl_minimo': 1.5, 'vl_medio': 1.56, 'vl_fechamento': 1.5, 'vl_mlh_oft_compra': 0.95, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 2, 'qt_tit_neg': 3000, 'vl_volume': 4700, 'vl_exec_opc': 19, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}, 'CSANW135': {'id': 7146316, 'tp_reg': 1, 'dt_pregao': 20221118, 'cd_bdi': '82', 'cd_acao': 'CSANW135', 'tp_merc': 80, 'nm_empresa_rdz': 'CSANE', 'especi': 'ON NM', 'prazot': '000', 'moeda_ref': 'R$', 'vl_abertura': 0.01, 'vl_maximo': 0.01, 'vl_minimo': 0.01, 'vl_medio': 0.01, 'vl_fechamento': 0.01, 'vl_mlh_oft_compra': 0, 'vl_mlh_oft_venda': 0, 'vl_ttl_neg': 1, 'qt_tit_neg': 100, 'vl_volume': 1, 'vl_exec_opc': 13.5, 'in_opc': '0', 'dt_vnct_opc': 20221118, 'ft_cotacao': 1, 'vl_exec_moeda_corrente': 0, 'cd_isin': 'BRCSANACNOR6', 'cd_acao_rdz': 'CSAN', 'created_at': '2022-11-19T02:30:44.000000Z', 'updated_at': '2022-11-19T02:30:44.000000Z'}}
    # data = None

    relevant_quote = quotes[company['cd_acao']]

    return render(request, "b3ack/company.html", {
        "company": company,
        "quotes": relevant_quote,
        "data": data
    })

@csrf_exempt
@login_required
def watchlist_view(request):
    if request.method == "POST":
        data = json.loads(request.body)

        # Fetching form data
        company_code = data['companyCode']
        interval = int(data['interval']) * 60 # Converted to minutes
        buy_value = int(data['buy_value'])
        sell_value = int(data['sell_value'])

        # Create a CompanyTracker for the user
        api = B3api()
        data = api.data[company_code]

        tracker = CompanyTracker(
            api_id     = data['id'],
            code       = data['cd_acao_rdz'],
            name       = data['nm_empresa'],
            user       = request.user,
            interval   = interval,
            buy_value  = buy_value,
            sell_value = sell_value
        )

        tracker.save()

        # Fetching user
        user_id = request.user.id
        user = InvestorUser.objects.get(id=user_id)

        # Adding Company to user's watchlist
        tracker = CompanyTracker.objects.filter(code=data['cd_acao_rdz'], user=request.user)[0]
        user.watchlist.add(tracker)

        
        print(bcolors.WARNING + f"Tracking {tracker.code} every {tracker.interval / 60} minutes for {tracker.user}!" + bcolors.ENDC)
        Tracking().start_tracking(tracker.interval, tracker.code, tracker.id)

        return JsonResponse({"message": "Added to watchlist successfully."}, status=201)

    else:
        return HttpResponseRedirect(reverse("index"))

@login_required()
def profile_view(request):
    active_trackers = request.user.tracks.all()
    print(active_trackers)
    return render(request, "b3ack/profile.html", {
        "active_trackers": active_trackers,
    })
